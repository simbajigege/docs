"use strict";(self.webpackChunkdyte_docs=self.webpackChunkdyte_docs||[]).push([[91311],{8327:(e,t,i)=>{i.d(t,{M:()=>b,T:()=>r,d:()=>a,e:()=>y,f:()=>c,g:()=>s,h:()=>o,i:()=>d,j:()=>n,k:()=>m,p:()=>w,r:()=>l,s:()=>v});i(55055);const n=e=>{let t=null;try{const i=JSON.parse(e.message),{target:n,message:a}=i;t=void 0===n||void 0===a?e:Object.assign(Object.assign({},e),{targetUserIds:n,message:a})}catch(i){t=e}return t};function a(e,t){return e.localeCompare(t)}function s(e){return e.sort(((e,t)=>e.localeCompare(t))).join("_")}function o(e,t){if(null==e)return!0;for(const i of e)if("file"===i.kind){const e=i.getAsFile();i.type.startsWith("image/")?t("image",e):t("file",e)}}const r="dm__";function d(e){return e.isDirectMessage}function c(e){return[...new Set(e)].sort(a).join("<>")}function l(e){return e.split("").reverse().join("")}const h=/^\*([^*\s]+)\*/,g=/^_([^_\s]+)_/,p=/^~([^~\s]+)~/,u=/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.,~#?&//=]*)/,m=/<blockquote>[.\s\S]*<\/blockquote>\n\n/m;function y(e,t=!1){if(!m.test(e))return"";let i=0,n=13;return t&&(i=12,n=0),e.substring(e.indexOf("<blockquote>")+i,e.indexOf("</blockquote>")+n)}function v(e){return e.replace(m,"")}const b=2e3,f=["<a>","<b>","<i>","<q>","<s>"];function w(e){e=(e=e.split(" ").map((e=>{if(u.test(e)){const t=u.exec(e);e=e.replace(t[0],`<a>${t[0]}</a>`)}else{if(h.test(e)){const t=h.exec(e);e=e.replace(t[0],`<b>${t[1]}</b>`)}if(g.test(e)){const t=g.exec(e);e=e.replace(t[0],`<i>${t[1]}</i>`)}if(p.test(e)){const t=p.exec(e);e=e.replace(t[0],`<s>${t[1]}</s>`)}}return e})).join(" ")).split(" ").map(((e,t)=>">"!==e||0!==t&&">"!==e[t-1]?e:"<q></q>")).join(" ");const[t]=x(e);return t}function x(e,t=""){const i=[];if(0===e.length)return[i,0];let n=0;for(;n<e.length;){if(t.length&&t===e.substring(n,n+t.length))return[i,n+t.length];if(f.includes(e.substring(n,n+3))){const[t,a]=x(e.substring(n+3),`</${e[n+1]}>`);i.push({type:e[n+1],content:1===t.length&&"plain_text"===t[0].type?t[0].content:t}),n+=a+3}else{let t=i[i.length-1];t&&"plain_text"===t.type||(i.push({type:"plain_text",content:""}),t=i[i.length-1]),t.content+=e[n],n++}}return[i,n]}},24613:(e,t,i)=>{i.d(t,{d:()=>n,e:()=>a,f:()=>s});const n=(e,t)=>{const i=t.getTime()-e.getTime();return Math.round(Math.abs(i/1e3/60))},a=(e,t)=>{const i=n(e,t);if(i<2)return"just now";if(i<60)return`${i}m ago`;const a=Math.round(i/60);if(i<90)return`about ${a}h ago`;if(a<24)return`${a}h ago`;const s=Math.round(a/24);if(s<7)return`${s}d ago`;return`${Math.round(s/7)}w ago`},s=e=>e.toDateString()+" "+e.toLocaleTimeString()},91364:(e,t,i)=>{i.d(t,{d:()=>b});var n=i(49583),a="[object Symbol]";var s=/\s/;var o=/^\s+/;function r(e){return e?e.slice(0,function(e){for(var t=e.length;t--&&s.test(e.charAt(t)););return t}(e)+1).replace(o,""):e}var d=NaN,c=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,h=/^0o[0-7]+$/i,g=parseInt;function p(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||(0,n.i)(e)&&(0,n.b)(e)==a}(e))return d;if((0,n.a)(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=(0,n.a)(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=r(e);var i=l.test(e);return i||h.test(e)?g(e.slice(2),i?2:8):c.test(e)?d:+e}var u=function(){return n.r.Date.now()},m="Expected a function",y=Math.max,v=Math.min;function b(e,t,i){var a,s,o,r,d,c,l=0,h=!1,g=!1,b=!0;if("function"!=typeof e)throw new TypeError(m);function f(t){var i=a,n=s;return a=s=void 0,l=t,r=e.apply(n,i)}function w(e){var i=e-c;return void 0===c||i>=t||i<0||g&&e-l>=o}function x(){var e=u();if(w(e))return k(e);d=setTimeout(x,function(e){var i=t-(e-c);return g?v(i,o-(e-l)):i}(e))}function k(e){return d=void 0,b&&a?f(e):(a=s=void 0,r)}function _(){var e=u(),i=w(e);if(a=arguments,s=this,c=e,i){if(void 0===d)return function(e){return l=e,d=setTimeout(x,t),h?f(e):r}(c);if(g)return clearTimeout(d),d=setTimeout(x,t),f(c)}return void 0===d&&(d=setTimeout(x,t)),r}return t=p(t)||0,(0,n.a)(i)&&(h=!!i.leading,o=(g="maxWait"in i)?y(p(i.maxWait)||0,t):o,b="trailing"in i?!!i.trailing:b),_.cancel=function(){void 0!==d&&clearTimeout(d),l=0,a=c=s=d=void 0},_.flush=function(){return void 0===d?r:k(u())},_}},93514:(e,t,i)=>{i.d(t,{d:()=>n});const n={designTokens:{spacingBase:4,googleFont:"Inter"},styles:{"dyte-header":{display:"grid",height:"48px",gridTemplateColumns:"repeat(3, 1fr)",gridTemplateRows:"1fr",alignItems:"center"},"dyte-header.sm":{display:"grid",gridArea:"header",gridTemplateColumns:"repeat(2, 1fr)",gridTemplateRows:"1fr",alignItems:"center"},"div#header-left":{display:"flex",alignItems:"center",height:"48px",wordBreak:"break-all"},"dyte-logo":{height:"26px"},"div#header-center":{display:"flex",alignItems:"center",justifyContent:"center",wordBreak:"break-all"},"div#header-right":{display:"flex",alignItems:"center",justifyContent:"flex-end"},"dyte-stage":{display:"flex",flex:"1"},"dyte-grid":{flex:"1",height:"auto"},"dyte-controlbar":{display:"grid",gridTemplateColumns:"repeat(3,1fr)",gridTemplateRows:"1fr",alignItems:"center",padding:"8px"},"dyte-controlbar.sm":{display:"flex",position:"relative",backgroundColor:"rgb(var(--dyte-colors-background-1000, 0 0 0))"},"dyte-controlbar.md":{display:"flex",position:"relative",backgroundColor:"rgb(var(--dyte-colors-background-1000, 0 0 0))"},"div#controlbar-left":{display:"flex",alignItems:"center"},"div#controlbar-center":{display:"flex",alignItems:"center",position:"relative",overflow:"visible",justifyContent:"center"},"div#controlbar-mobile":{display:"flex",flex:"1",alignItems:"center",justifyContent:"center"},"div#controlbar-right":{display:"flex",alignItems:"center",justifyContent:"flex-end"},"dyte-settings":{width:"720px",height:"480px"},"dyte-debugger":{width:"720px",height:"480px"},"dyte-breakout-rooms-manager":{minHeight:"400px",minWidth:"500px",maxWidth:"80%",maxHeight:"480px"},"div#setupcontrols-media":{position:"absolute",bottom:"8px",right:"8px",display:"flex"},"div#setupcontrols-settings":{position:"absolute",top:"8px",right:"8px"},"dyte-meeting-title.sm":{marginLeft:"0"},"dyte-clock":{marginRight:"0"}},root:{"dyte-meeting":{state:"meeting",states:["activeSidebar","activeAI"]},"dyte-meeting[meeting=waiting]":["dyte-waiting-screen"],"dyte-meeting[meeting=idle]":["dyte-idle-screen"],"dyte-meeting[meeting=setup]":["dyte-setup-screen","dyte-dialog-manager"],"dyte-meeting[meeting=joined]":["dyte-header","dyte-stage","dyte-controlbar","dyte-participants-audio","dyte-dialog-manager"],"dyte-meeting[meeting=joined].activeSidebar.sm":{add:[["dyte-sidebar",{view:"full-screen"}]]},"dyte-meeting[meeting=joined].activeSidebar.md":{add:[["dyte-sidebar",{view:"full-screen"}]]},"dyte-meeting[meeting=joined].activeAI.sm":{add:[["dyte-ai",{view:"full-screen"}]]},"dyte-meeting[meeting=joined].activeAI.md":{add:[["dyte-ai",{view:"full-screen"}]]},"dyte-meeting[meeting=ended]":["dyte-ended-screen"],"dyte-header":["div#header-left","div#header-center","div#header-right"],"dyte-header.sm":{remove:["div#header-center"]},"div#header-left":["dyte-logo","dyte-recording-indicator","dyte-livestream-indicator"],"div#header-center":["dyte-meeting-title"],"div#header-right":["dyte-grid-pagination","dyte-clock","dyte-participant-count","dyte-viewer-count"],"div#header-left.sm":["dyte-meeting-title","dyte-recording-indicator","dyte-livestream-indicator"],"dyte-stage":{states:["activeSidebar","activeAI"],children:["dyte-grid","dyte-notifications","dyte-transcripts"]},"dyte-stage.activeSidebar":{add:[["dyte-sidebar",{view:"sidebar"}]]},"dyte-stage.activeSidebar.sm":{remove:["dyte-sidebar"]},"dyte-stage.activeAI":{add:[["dyte-ai",{view:"sidebar"}]]},"dyte-stage.activeAI.sm":{remove:["dyte-ai"]},"dyte-grid":{states:["activeScreenShare","activePlugin","activeSpotlight"],children:["dyte-simple-grid"]},"dyte-grid.activeSpotlight":["dyte-spotlight-grid"],"dyte-grid.activeScreenShare":["dyte-mixed-grid"],"dyte-grid.activePlugin":["dyte-mixed-grid"],"dyte-grid.activeScreenShare.activeSpotlight":["dyte-mixed-grid"],"dyte-grid.activePlugin.activeSpotlight":["dyte-mixed-grid"],"dyte-grid.activePlugin.activeScreenShare.activeSpotlight":["dyte-mixed-grid"],"dyte-mixed-grid":{states:["activeSpotlight"],children:["dyte-simple-grid"]},"dyte-mixed-grid.activeSpotlight":["dyte-spotlight-grid"],"dyte-participant-tile":{state:"meeting",children:["dyte-name-tag","dyte-avatar","dyte-network-indicator"]},"dyte-participant-setup":["dyte-avatar","div#setupcontrols-media"],"dyte-participant-tile[meeting=setup]":["dyte-avatar","div#setupcontrols-settings","div#setupcontrols-media"],"div#setupcontrols-media":[["dyte-mic-toggle",{size:"sm"}],["dyte-camera-toggle",{size:"sm"}]],"div#setupcontrols-settings":[["dyte-settings-toggle",{size:"sm"}]],"dyte-screenshare-view":{children:["dyte-name-tag","dyte-network-indicator"]},"dyte-name-tag":[["dyte-audio-visualizer",{slot:"start"}]],"dyte-controlbar":{states:["activeMoreMenu"],props:{variant:"solid"},children:["div#controlbar-left","div#controlbar-center","div#controlbar-right"]},"dyte-more-toggle":{states:["activeMoreMenu"],children:[]},"dyte-controlbar.sm":["div#controlbar-mobile"],"dyte-controlbar.md":["div#controlbar-mobile"],"dyte-more-toggle.activeMoreMenu":[["dyte-fullscreen-toggle",{variant:"horizontal",slot:"more-elements"}],["dyte-pip-toggle",{variant:"horizontal",slot:"more-elements"}],["dyte-caption-toggle",{variant:"horizontal",slot:"more-elements"}],["dyte-mute-all-button",{variant:"horizontal",slot:"more-elements"}],["dyte-breakout-rooms-toggle",{variant:"horizontal",slot:"more-elements"}],["dyte-recording-toggle",{variant:"horizontal",slot:"more-elements"}],["dyte-debugger-toggle",{variant:"horizontal"}]],"dyte-more-toggle.activeMoreMenu.sm":[["dyte-chat-toggle",{variant:"horizontal",slot:"more-elements"}],["dyte-participants-toggle",{variant:"horizontal",slot:"more-elements"}],["dyte-polls-toggle",{variant:"horizontal",slot:"more-elements"}],["dyte-plugins-toggle",{variant:"horizontal",slot:"more-elements"}],["dyte-fullscreen-toggle",{variant:"horizontal",slot:"more-elements"}],["dyte-screen-share-toggle",{variant:"horizontal",slot:"more-elements"}],["dyte-pip-toggle",{variant:"horizontal",slot:"more-elements"}],["dyte-caption-toggle",{variant:"horizontal",slot:"more-elements"}],["dyte-mute-all-button",{variant:"horizontal",slot:"more-elements"}],["dyte-breakout-rooms-toggle",{variant:"horizontal",slot:"more-elements"}],["dyte-settings-toggle",{variant:"horizontal",slot:"more-elements"}],["dyte-ai-toggle",{variant:"horizontal"}],["dyte-debugger-toggle",{variant:"horizontal"}]],"dyte-more-toggle.activeMoreMenu.md":[["dyte-chat-toggle",{variant:"horizontal",slot:"more-elements"}],["dyte-participants-toggle",{variant:"horizontal",slot:"more-elements"}],["dyte-polls-toggle",{variant:"horizontal",slot:"more-elements"}],["dyte-plugins-toggle",{variant:"horizontal",slot:"more-elements"}],["dyte-fullscreen-toggle",{variant:"horizontal",slot:"more-elements"}],["dyte-screen-share-toggle",{variant:"horizontal",slot:"more-elements"}],["dyte-pip-toggle",{variant:"horizontal",slot:"more-elements"}],["dyte-caption-toggle",{variant:"horizontal",slot:"more-elements"}],["dyte-mute-all-button",{variant:"horizontal",slot:"more-elements"}],["dyte-breakout-rooms-toggle",{variant:"horizontal",slot:"more-elements"}],["dyte-settings-toggle",{variant:"horizontal",slot:"more-elements"}],["dyte-ai-toggle",{variant:"horizontal"}],["dyte-debugger-toggle",{variant:"horizontal"}]],"div#controlbar-mobile":["dyte-mic-toggle","dyte-camera-toggle","dyte-webinar-stage-toggle","dyte-stage-toggle","dyte-leave-button","dyte-more-toggle"],"div#controlbar-left":["dyte-settings-toggle","dyte-screen-share-toggle","dyte-livestream-toggle"],"div#controlbar-center":["dyte-mic-toggle","dyte-camera-toggle","dyte-webinar-stage-toggle","dyte-stage-toggle","dyte-more-toggle","dyte-leave-button"],"div#controlbar-right":["dyte-chat-toggle","dyte-polls-toggle","dyte-participants-toggle","dyte-plugins-toggle","dyte-ai-toggle"]},config:{notification_sounds:{participant_left:!1},participant_joined_sound_notification_limit:10,participant_chat_message_sound_notification_limit:10,videoFit:"cover"}}},91311:(e,t,i)=>{i.r(t),i.d(t,{dyte_channel_header:()=>b,dyte_channel_selector_view:()=>f,dyte_chat_composer_view:()=>w,dyte_chat_messages_ui:()=>x,dyte_chat_messages_ui_paginated:()=>k,dyte_chat_search_results:()=>_,dyte_dialog_manager:()=>C,dyte_notifications:()=>j});var n=i(72944),a=i(26468),s=(i(60064),i(94370)),o=i(17073),r=i(74157),d=i(55055),c=i(91364),l=i(8327),h=i(24613),g=i(32599),p=i(93514),u=i(17213),m=i(36766),y=i(85872),v=i(1821);i(70694),i(64383),i(49583);const b=class{constructor(e){(0,n.r)(this,e),this.search=(0,n.c)(this,"search",7),this.searchDismissed=(0,n.c)(this,"searchDismissed",7),this.back=(0,n.c)(this,"back",7),this.meeting=void 0,this.channel=void 0,this.iconPack=o.d,this.t=(0,r.u)(),this.showChannelDetailsDialog=!1,this.showSearchBar=!1,this.members=[],this.showBackButton=!1}onChannelChanged(){this.$searchInput&&(this.$searchInput.value=""),this.showSearchBar=!1,this.channel.isDirectMessage||this.meeting.chat.getChannelMembers(this.channel.id).then((e=>{this.members=e}))}connectedCallback(){this.onChannelChanged()}renderChannelDetails(){return(0,n.h)("dyte-dialog",{open:!0,onDyteDialogClose:()=>{this.showChannelDetailsDialog=!1},iconPack:this.iconPack,t:this.t},(0,n.h)("dyte-channel-details",{members:this.members,channel:this.channel}))}render(){return this.channel?(0,n.h)(n.H,null,this.showChannelDetailsDialog&&this.renderChannelDetails(),(0,n.h)("header",{class:{searching:this.showSearchBar}},this.showBackButton&&(0,n.h)("dyte-button",{kind:"icon",variant:"secondary",class:"back-btn",onClick:()=>{this.back.emit()}},(0,n.h)("dyte-icon",{icon:this.iconPack.chevron_left})),(0,n.h)("div",{class:"channel-details"},(0,n.h)("span",{class:"name"},this.channel.displayName),!this.channel.isDirectMessage&&(0,n.h)("span",{class:"members"},this.members.map((e=>e.name)).join(", "))),(0,n.h)("div",{class:"channel-tools"},!this.channel.isDirectMessage&&(0,n.h)("dyte-tooltip",{label:this.t("chat.channel_members"),iconPack:this.iconPack,t:this.t,variant:"primary"},(0,n.h)("dyte-button",{iconPack:this.iconPack,t:this.t,kind:"button",variant:"secondary",size:"md",onClick:()=>{this.showChannelDetailsDialog=!this.showChannelDetailsDialog},class:"br-primary-btn"},(0,n.h)("dyte-icon",{icon:this.iconPack.people,iconPack:this.iconPack,t:this.t})))))):null}static get watchers(){return{channel:["onChannelChanged"]}}};b.style="header{box-sizing:border-box;height:var(--dyte-space-16, 64px);width:100%;padding:var(--dyte-space-4, 16px);display:flex;justify-content:space-between;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-1000, 8 8 8) / var(--tw-bg-opacity));border-left-width:var(--dyte-border-width-none, 0);border-right-width:var(--dyte-border-width-none, 0);border-bottom-width:var(--dyte-border-width-sm, 1px);border-top-width:var(--dyte-border-width-none, 0);border-style:solid;--tw-border-opacity:1;border-bottom-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-border-opacity))}header.searching{justify-content:flex-end}header.searching .channel-details{display:none}header .channel-details{display:flex;flex-grow:1;flex-direction:column;justify-content:center;height:var(--dyte-space-9, 36px);width:var(--dyte-space-1, 4px)}header .channel-details .name{font-weight:500}header .channel-details .members{margin-top:var(--dyte-space-0\\.5, 2px);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-size:12px;color:rgb(var(--dyte-colors-text-600, 255 255 255 / 0.52))}header .channel-tools{display:flex;flex-shrink:0;justify-content:flex-end;gap:var(--dyte-space-1, 4px);min-width:var(--dyte-space-24, 96px)}header .channel-tools dyte-tooltip{height:var(--dyte-space-8, 32px);width:var(--dyte-space-10, 40px);display:flex}header .search-input{height:var(--dyte-space-8, 32px);width:var(--dyte-space-48, 192px);padding-left:var(--dyte-space-2, 8px);padding-right:var(--dyte-space-2, 8px);border-width:var(--dyte-border-width-none, 0);border-style:none;outline:2px solid transparent;outline-offset:2px;border-radius:var(--dyte-border-radius-sm, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-1000, 255 255 255))}header .name{font-size:16px}header .br-primary-btn{background-color:transparent}header .br-primary-btn:hover{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity))}@media (orientation: landscape) and (min-width: 400px){header.searching .channel-details{display:flex}}.back-btn{margin-right:var(--dyte-space-3, 12px)}";const f=class{constructor(e){(0,n.r)(this,e),this.channelChange=(0,n.c)(this,"channelChange",7),this.calculateListHeight=(0,c.d)((()=>{if("list"===this.viewAs&&this.$listEl){let e=0;const t=this.$el.shadowRoot.querySelector('slot[name="header"]');t&&t.assignedElements().forEach((t=>e+=t.offsetHeight)),this.$searchEl&&(e+=this.$searchEl.offsetHeight),this.$listEl.style.height=window.innerHeight-e-16+"px"}}),60),this.getFilteredChannels=()=>""===this.searchQuery.trim()?this.channels:this.channels.filter((e=>e.name.toLowerCase().includes(this.searchQuery.toLowerCase()))),this.toggleDropdown=()=>{this.showDropdown=!this.showDropdown},this.getChannelById=e=>this.channels.find((t=>t.id===e)),this.getTotalUnreads=()=>this.channels.reduce(((e,t)=>e+t.unreadCount),0),this.onChannelClickHandler=e=>{this.channelChange.emit(e),"dropdown"===this.viewAs&&(this.showDropdown=!1)},this.channels=void 0,this.selectedChannelId=void 0,this.disableSearch=!1,this.hideAvatar=!1,this.iconPack=o.d,this.t=(0,r.u)(),this.viewAs="list",this.searchQuery="",this.showDropdown=!1}connectedCallback(){this.resizeObserver=new ResizeObserver(this.calculateListHeight)}componentDidLoad(){this.resizeObserver.observe(this.$el),this.calculateListHeight()}disconnectedCallback(){var e;null===(e=this.resizeObserver)||void 0===e||e.disconnect(),this.calculateListHeight.cancel()}getTimeLabel(e){const t=new Date,i=new Date(t);i.setDate(t.getDate()-1);const n=new Date(t);if(n.setDate(t.getDate()-t.getDay()-1),e.toDateString()===t.toDateString())return e.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});if(e.toDateString()===i.toDateString())return this.t("date.yesteday");if(e>n){const t=["date.sunday","date.monday","date.tuesday","date.wednesday","date.thursday","date.friday","date.saturday"];return this.t(t[e.getDay()])}return Intl.DateTimeFormat([],{day:"2-digit",month:"2-digit",year:"2-digit"}).format(e)}render(){const e=this.getFilteredChannels(),t="list"===this.viewAs||"dropdown"===this.viewAs&&this.showDropdown;return(0,n.h)(n.H,null,"list"===this.viewAs&&(0,n.h)("slot",{name:"header"}),t&&(0,n.h)("div",{class:{dropdown:"dropdown"===this.viewAs,scrollbar:"dropdown"===this.viewAs,list:"list"===this.viewAs}},!this.disableSearch&&(0,n.h)("div",{class:"search-container",ref:e=>this.$searchEl=e},(0,n.h)("input",{type:"text",placeholder:this.t("chat.search_conversations"),value:this.searchQuery,onInput:e=>this.searchQuery=e.target.value}),(0,n.h)("dyte-icon",{icon:this.iconPack.search})),(0,n.h)("div",{class:"channels-container scrollbar",ref:e=>this.$listEl=e},e.map((e=>(0,n.h)("button",{class:{channel:!0,active:this.selectedChannelId===e.id},onClick:()=>this.onChannelClickHandler(e)},!this.hideAvatar&&(0,n.h)("div",null,e.icon?(0,n.h)("dyte-icon",{class:"avatar-icon",icon:this.iconPack[e.icon]}):(0,n.h)("dyte-avatar",{participant:{name:e.name,picture:e.avatarUrl}})),(0,n.h)("div",{class:"channel-data"},(0,n.h)("div",{class:"col"},(0,n.h)("div",{class:"name"},e.name),e.latestMessage&&(0,n.h)("div",{class:{"last-message":!0,"no-message":!e.latestMessage}},(0,n.h)("dyte-text-message-view",{isMarkdown:!0,text:e.latestMessage}))),(0,n.h)("div",{class:"col channel-meta"},e.latestMessageTime&&(0,n.h)("time",{class:"time"},this.getTimeLabel(e.latestMessageTime)),e.unreadCount>0&&(0,n.h)("div",{class:"unread-count"},e.unreadCount)))))))),"dropdown"===this.viewAs&&(0,n.h)("button",{class:"dropdown-trigger",onClick:this.toggleDropdown},(0,n.h)("span",null,this.selectedChannelId&&`${this.t("to")} ${this.getChannelById(this.selectedChannelId).name}`,this.getTotalUnreads()>0&&(0,n.h)("div",{class:"unread-count"},this.getTotalUnreads())),(0,n.h)("dyte-icon",{icon:this.showDropdown?this.iconPack.chevron_up:this.iconPack.chevron_down})))}get $el(){return(0,n.a)(this)}};f.style=".scrollbar {\n  /* For Firefox */\n  scrollbar-width: thin;\n  scrollbar-color: var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))\n    var(--dyte-scrollbar-background, transparent);\n}\n\n/* For WebKit */\n.scrollbar::-webkit-scrollbar {\n  height: var(--dyte-space-1\\.5, 6px);\n  width: var(--dyte-space-1\\.5, 6px);\n  border-radius: 9999px;\n  background-color: var(--dyte-scrollbar-background, transparent);\n}\n\n.scrollbar::-webkit-scrollbar-thumb {\n  border-radius: 9999px;\n  background-color: var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)));\n}\n\n\n:host {\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));\n  position: relative;\n  z-index: 10;\n  height: var(--dyte-space-12, 48px);\n  min-height: 48px;\n}\n\n.dropdown-trigger {\n  height: 100%;\n  width: 100%;\n  border-width: var(--dyte-border-width-none, 0);\n  border-style: none;\n  padding: var(--dyte-space-4, 16px);\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity));\n  font-size: 14px;\n  color: rgb(var(--dyte-colors-text-1000, 255 255 255));\n  cursor: pointer;\n  position: absolute;\n  z-index: 20;\n}\n\n.dropdown-trigger span {\n  display: flex;\n  flex: 1 1 0%;\n  align-items: center;\n  justify-content: space-between;\n}\n\n.dropdown-trigger dyte-icon {\n  margin-left: var(--dyte-space-1, 4px);\n  height: var(--dyte-space-5, 20px);\n  width: var(--dyte-space-5, 20px);\n  flex-shrink: 0;\n}\n\n@container chatcontainer (height < 360px) {\n  .dropdown-trigger {\n    padding: var(--dyte-space-2, 8px);\n  }\n  .dropdown {\n    top: var(--dyte-space-8, 32px) !important;\n  }\n  .search-container {\n    padding-left: var(--dyte-space-0, 0px) !important;\n    padding-right: var(--dyte-space-0, 0px) !important;\n    padding-top: var(--dyte-space-0, 0px) !important;\n    padding-bottom: var(--dyte-space-0, 0px) !important;\n  }\n  input {\n    height: var(--dyte-space-8, 32px) !important;\n    border-radius: var(--dyte-border-radius-none, 0) !important;\n  }\n  .channel {\n    height: var(--dyte-space-8, 32px) !important;\n    border-radius: var(--dyte-border-radius-sm, 4px) !important;\n  }\n  .avatar-icon {\n    height: var(--dyte-space-3, 12px) !important;\n    width: var(--dyte-space-3, 12px) !important;\n    padding: var(--dyte-space-1, 4px) !important;\n  }\n\n  dyte-avatar {\n    height: var(--dyte-space-5, 20px) !important;\n    width: var(--dyte-space-5, 20px) !important;\n  }\n}\n\n.dropdown {\n  position: absolute;\n  width: 100%;\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));\n  top: var(--dyte-space-12, 48px);\n  z-index: 10;\n  animation: 0.3s slide-down ease;\n}\n\n.dropdown .channels-container {\n  max-height: var(--dyte-space-80, 320px);\n}\n\n.list {\n  display: flex;\n  flex-direction: column;\n}\n\n.list .channel .channel-data {\n  align-items: flex-start;\n}\n\n.unread-count {\n  display: flex;\n  justify-content: center;\n  height: var(--dyte-space-5, 20px);\n  min-width: var(--dyte-space-3, 12px);\n  border-radius: 9999px;\n  padding-left: var(--dyte-space-1, 4px);\n  padding-right: var(--dyte-space-1, 4px);\n  font-size: 12px;\n  line-height: 1.25rem;\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-bg-opacity));\n  color: rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)));\n}\n\ninput {\n  height: var(--dyte-space-9, 36px);\n  width: 100%;\n  padding-left: var(--dyte-space-3, 12px);\n  padding-right: var(--dyte-space-3, 12px);\n  box-sizing: border-box;\n  border-width: var(--dyte-border-width-none, 0);\n  border-style: none;\n  outline: 2px solid transparent;\n  outline-offset: 2px;\n  border-radius: var(--dyte-border-radius-sm, 4px);\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity));\n  color: rgb(var(--dyte-colors-text-1000, 255 255 255));\n}\n\n.search-container {\n  display: flex;\n  flex-shrink: 0;\n  flex-grow: 0;\n  flex-basis: auto;\n  align-items: center;\n  padding-top: var(--dyte-space-3, 12px);\n  padding-bottom: var(--dyte-space-3, 12px);\n  padding-left: var(--dyte-space-2, 8px);\n  padding-right: var(--dyte-space-2, 8px);\n  border-bottom: var(--dyte-border-width-sm, 1px) solid rgb(var(--dyte-colors-background-700, 44 44 44));\n}\n\n.search-container dyte-icon {\n  margin-left: calc(var(--dyte-space-8, 32px) * -1);\n  height: var(--dyte-space-5, 20px);\n  width: var(--dyte-space-5, 20px);\n  color: rgb(var(--dyte-colors-text-800, 255 255 255 / 0.76));\n}\n\n.channels-container {\n  display: flex;\n  flex-direction: column;\n  gap: var(--dyte-space-1, 4px);\n  padding: var(--dyte-space-2, 8px);\n  flex: 1 1 auto;\n  overflow-y: auto;\n}\n\n.channel {\n  flex-shrink: 0;\n  box-sizing: border-box;\n  border-width: var(--dyte-border-width-none, 0);\n  border-style: none;\n  background-color: transparent;\n  outline: 2px solid transparent;\n  outline-offset: 2px;\n  cursor: pointer;\n  border-radius: var(--dyte-border-radius-md, 8px);\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  gap: var(--dyte-space-2, 8px);\n  height: var(--dyte-space-16, 64px);\n  width: 100%;\n  padding-left: var(--dyte-space-2, 8px);\n  padding-right: var(--dyte-space-3, 12px);\n  color: rgb(var(--dyte-colors-text-1000, 255 255 255));\n  transition-property: color, background-color, border-color, fill, stroke, -webkit-text-decoration-color;\n  transition-property: color, background-color, border-color, text-decoration-color, fill, stroke;\n  transition-property: color, background-color, border-color, text-decoration-color, fill, stroke, -webkit-text-decoration-color;\n  transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n  transition-duration: 150ms;\n}\n\n.channel:hover {\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity));\n}\n\n.channel .channel-data {\n  flex: 1 1 0%;\n  align-items: center;\n  justify-content: space-between;\n  display: flex;\n  gap: var(--dyte-space-2, 8px);\n}\n\n.channel .name {\n  font-size: 16px;\n}\n\n.channel .name, \n  .channel .last-message {\n  max-width: var(--dyte-space-40, 160px);\n  text-align: left;\n  overflow: hidden;\n  display: -webkit-box;\n  -webkit-box-orient: vertical;\n  -webkit-line-clamp: 1;\n}\n\n.channel .no-message {\n  font-style: italic;\n}\n\n.channel dyte-avatar {\n  height: var(--dyte-space-12, 48px);\n  width: var(--dyte-space-12, 48px);\n  overflow: clip;\n  border-radius: 9999px;\n  font-size: 14px;\n}\n\n.channel .avatar-icon {\n  height: var(--dyte-space-6, 24px);\n  width: var(--dyte-space-6, 24px);\n  padding: var(--dyte-space-3, 12px);\n  color: rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)));\n  overflow: clip;\n  border-radius: 9999px;\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-bg-opacity));\n}\n\n.channel time, \n  .channel .last-message {\n  font-size: 12px;\n  color: rgb(var(--dyte-colors-text-800, 255 255 255 / 0.76));\n}\n\n.channel.active {\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-brand-300, 73 124 253) / var(--tw-bg-opacity));\n  color: rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)));\n}\n\n.channel.active .unread-count {\n  background-color: rgb(var(--dyte-colors-text-on-brand-800, var(--dyte-colors-text-800, 255 255 255 / 0.76)));\n  --tw-text-opacity: 1;\n  color: rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-text-opacity));\n}\n\n.channel.active time {\n  color: rgb(var(--dyte-colors-text-on-brand-800, var(--dyte-colors-text-800, 255 255 255 / 0.76)));\n}\n\n.channel.active .last-message {\n  color: rgb(var(--dyte-colors-text-on-brand-700, var(--dyte-colors-text-700, 255 255 255 / 0.64)));\n}\n\n.channel.active dyte-avatar {\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-bg-opacity));\n  color: rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)));\n}\n\n.col {\n  gap: var(--dyte-space-1, 4px);\n  display: flex;\n  flex-direction: column;\n}\n\n.channel-meta {\n  flex-shrink: 0;\n  align-items: flex-end;\n}\n\n@keyframes slide-down {\n  from {\n    transform: translateY(-50px);\n  }\n  to {\n    transform: translateY(0%);\n  }\n}\n";const w=class{constructor(e){(0,n.r)(this,e),this.onNewMessage=(0,n.c)(this,"newMessage",7),this.onEditMessage=(0,n.c)(this,"editMessage",7),this.onEditCancel=(0,n.c)(this,"editCancel",7),this.onQuotedMessageDismiss=(0,n.c)(this,"quotedMessageDismiss",7),this.textMessage="",this.sendFile=()=>{this.canSendFiles&&("image"===this.fileToUpload.type?this.onNewMessage.emit({type:"image",image:this.fileToUpload.file}):this.onNewMessage.emit({type:"file",file:this.fileToUpload.file}),this.fileToUpload=null)},this.handleSendMessage=()=>{if(!this.canSendTextMessage)return;if(null!==this.fileToUpload)return void this.sendFile();const e=this.textMessage;e.length>0&&(this.quotedMessage.length,this.onNewMessage.emit({type:"text",message:e}),this.cleanup())},this.handleEditMessage=()=>{this.onEditMessage.emit(this.textMessage),this.cleanup()},this.handleEditCancel=()=>{this.onEditCancel.emit(),this.cleanup()},this.onTextChangeHandler=e=>{this.textMessage=e.detail,d.a.setItem(this.storageKey,e.detail)},this.onKeyDownHandler=e=>{"Enter"===e.key&&e.shiftKey||"Enter"===e.key&&(e.preventDefault(),this.isEditing?this.handleEditMessage():this.handleSendMessage())},this.onFileUploadHandler=(e,t)=>{this.fileToUpload={type:e,file:t}},this.onQuotedMessageDismissHandler=()=>{this.onQuotedMessageDismiss.emit()},this.cleanup=()=>{this.textMessage="",this.fileToUpload=null,d.a.setItem(this.storageKey,""),this.$textComposer.setText("",!0),this.isEmojiPickerOpen=!1},this.canSendTextMessage=!0,this.canSendFiles=!0,this.message="",this.quotedMessage="",this.storageKey="dyte-text-message",this.inputTextPlaceholder="Enter your message",this.isEditing=!1,this.iconPack=o.d,this.t=(0,r.u)(),this.disableEmojiPicker=!1,this.fileToUpload=null,this.isEmojiPickerOpen=!1}connectedCallback(){this.textMessage=this.message||d.a.getItem(this.storageKey)||""}componentWillUpdate(){this.textMessage=this.message||d.a.getItem(this.storageKey)||""}componentDidLoad(){this.message&&(0,n.w)((()=>this.$textComposer.setText(this.message,!0)))}render(){const e={iconPack:this.iconPack,t:this.t};return(0,n.h)(n.H,null,this.canSendTextMessage&&this.isEmojiPickerOpen&&(0,n.h)("dyte-emoji-picker",Object.assign({part:"emoji-picker",onPickerClose:()=>{this.isEmojiPickerOpen=!1},onDyteEmojiClicked:e=>{this.textMessage+=e.detail,this.$textComposer.setText(this.textMessage,!0)}},e)),(0,n.h)("slot",{name:"chat-addon"}),this.quotedMessage&&0!==this.quotedMessage.length&&(0,n.h)("div",{class:"quoted-message-container",part:"quoted-message-container"},(0,n.h)("div",{class:"quoted-message scrollbar"},(0,n.h)("dyte-text-message-view",{text:this.quotedMessage,isMarkdown:!0})),(0,n.h)("div",null,(0,n.h)("dyte-icon",Object.assign({"aria-label":this.t("dismiss"),class:"dismiss",icon:this.iconPack.dismiss,onClick:this.onQuotedMessageDismissHandler},e)))),(0,n.h)("div",{class:"composer-container"},(0,n.h)("div",{class:"composers"},this.fileToUpload&&(0,n.h)("dyte-draft-attachment-view",{attachment:this.fileToUpload,onDeleteAttachment:()=>this.fileToUpload=null}),!this.fileToUpload&&(0,n.h)("dyte-text-composer-view",{value:this.textMessage,placeholder:this.inputTextPlaceholder,onTextChange:this.onTextChangeHandler,keyDownHandler:this.onKeyDownHandler,maxLength:l.M,ref:e=>this.$textComposer=e})),(0,n.h)("div",{class:"chat-buttons",part:"chat-buttons"},(0,n.h)("div",{class:"left",part:"chat-buttons-left"},!this.fileToUpload&&!this.isEditing&&(0,n.h)("div",null,this.canSendFiles&&[(0,n.h)("dyte-file-picker-button",{onFileChange:e=>this.onFileUploadHandler("file",e.detail)}),(0,n.h)("dyte-file-picker-button",{filter:"image/*",label:this.t("chat.send_img"),icon:"image",onFileChange:e=>this.onFileUploadHandler("image",e.detail)})],this.canSendTextMessage&&!this.disableEmojiPicker&&(0,n.h)("dyte-emoji-picker-button",{isActive:this.isEmojiPickerOpen,onClick:()=>{this.isEmojiPickerOpen=!this.isEmojiPickerOpen}}),(0,n.h)("slot",{name:"chat-buttons"}))),(0,n.h)("div",{class:"right",part:"chat-buttons-right"},!this.isEditing&&(0,n.h)("dyte-tooltip",Object.assign({variant:"primary",label:this.t("chat.send_msg"),delay:2e3},e),(0,n.h)("dyte-button",Object.assign({kind:"icon",onClick:()=>this.handleSendMessage(),title:this.t("chat.send_msg")},e),(0,n.h)("dyte-icon",{icon:this.iconPack.send}))),this.isEditing&&(0,n.h)("div",{class:"edit-buttons"},(0,n.h)("dyte-tooltip",Object.assign({variant:"secondary",label:this.t("cancel"),delay:2e3},e),(0,n.h)("dyte-button",Object.assign({kind:"icon",variant:"secondary",onClick:()=>this.handleEditCancel(),title:this.t("cancel")},e),(0,n.h)("dyte-icon",{icon:this.iconPack.dismiss}))),(0,n.h)("dyte-tooltip",Object.assign({variant:"primary",label:this.t("chat.update_msg"),delay:2e3},e),(0,n.h)("dyte-button",Object.assign({kind:"icon",onClick:()=>this.handleEditMessage(),title:this.t("chat.send_msg")},e),(0,n.h)("dyte-icon",{icon:this.iconPack.checkmark}))))))))}};w.style=":host {\n  display: flex;\n  flex-direction: column;\n  font-family: var(--dyte-font-family, sans-serif);\n  font-size: 14px;\n  position: relative;\n}\n\n.quoted-message-container {\n  margin-bottom: var(--dyte-space-2, 8px);\n  display: flex;\n  justify-content: space-between;\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity));\n  color: rgb(var(--dyte-colors-text-1000, 255 255 255));\n  border-radius: var(--dyte-border-radius-md, 8px);\n  border: var(--dyte-border-width-sm, 1px) solid rgb(var(--dyte-colors-background-600, 60 60 60));\n}\n\n.quoted-message-container .quoted-message {\n  flex: 1 1 0%;\n  padding: var(--dyte-space-2, 8px);\n  border-radius: var(--dyte-border-radius-md, 8px);\n  max-height: var(--dyte-space-24, 96px);\n  overflow-y: auto;\n  word-break: break-all;\n}\n\n.quoted-message-container .quoted-message blockquote {\n  display: none;\n}\n\n.quoted-message-container dyte-icon.dismiss {\n  margin-left: auto;\n  height: var(--dyte-space-5, 20px);\n  width: var(--dyte-space-5, 20px);\n  padding: var(--dyte-space-2, 8px);\n  border-radius: var(--dyte-border-radius-md, 8px);\n  color: rgb(var(--dyte-colors-text-600, 255 255 255 / 0.52));\n}\n\n.quoted-message-container dyte-icon.dismiss:hover {\n  cursor: pointer;\n  color: rgb(var(--dyte-colors-text-1000, 255 255 255));\n}\n\n.quoted-message-container dyte-icon.dismiss {\n  transition-property: color, background-color, border-color, fill, stroke, -webkit-text-decoration-color;\n  transition-property: color, background-color, border-color, text-decoration-color, fill, stroke;\n  transition-property: color, background-color, border-color, text-decoration-color, fill, stroke, -webkit-text-decoration-color;\n  transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n  transition-duration: 150ms;\n}\n\n.composer-container {\n  position: relative;\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity));\n  border-radius: var(--dyte-border-radius-md, 8px);\n  overflow: hidden;\n  border: var(--dyte-border-width-sm, 1px) solid rgb(var(--dyte-colors-background-600, 60 60 60));\n}\n\n.composer-container > .composers {\n    min-height: 60px;\n  }\n\n@container chatcontainer (height < 360px) {\n    .composer-container > .composers {\n      min-height: 30px;\n    }\n}\n\n.chat-buttons {\n  padding: var(--dyte-space-3, 12px);\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));\n  color: rgb(var(--dyte-colors-text-1000, 255 255 255));\n}\n\n.chat-buttons .right {\n  z-index: 10;\n}\n\n.chat-buttons .right .edit-buttons {\n  display: flex;\n  gap: var(--dyte-space-2, 8px);\n}\n\n.chat-buttons > div {\n  display: flex;\n  align-items: center;\n}\n\ndyte-emoji-picker {\n  z-index: 20;\n  position: absolute;\n  top: calc(var(--dyte-space-72, 288px) * -1);\n  border-top: var(--dyte-border-width-sm, 1px) solid rgb(var(--dyte-colors-background-600, 60 60 60));\n  animation: 0.3s slide-up ease;\n}\n\n@keyframes slide-up {\n  from {\n    transform: translateY(100%);\n  }\n  to {\n    transform: translateY(0%);\n  }\n}\n";const x=class{constructor(e){(0,n.r)(this,e),this.onPinMessage=(0,n.c)(this,"pinMessage",7),this.stateUpdate=(0,n.c)(this,"dyteStateUpdate",7),this.observingEl=[],this.autoScrollEnabled=!0,this.onScroll=e=>{const t=e.target;(0,n.w)((()=>{const{scrollTop:e,clientHeight:i,scrollHeight:n}=t;e+i+10>=n?(this.autoScrollEnabled=!0,this.showLatestMessageButton=!1):this.autoScrollEnabled=!1}))},this.scrollToBottom=()=>{(0,g.s)(this.$chat)},this.observeMessage=e=>{e&&this.observingEl.push(e);try{this.intersectionObserver.observe(e)}catch(t){}},this.getMessageActions=e=>{const t=[];return!e.pinned&&this.canPinMessages&&t.push({id:"pin_message",label:this.t("pin"),icon:this.iconPack.pin}),t},this.onMessageActionHandler=(e,t)=>{if("pin_message"===e)this.onPinMessage.emit(t)},this.selectedGroup=void 0,this.messages=[],this.selfUserId=void 0,this.canPinMessages=!1,this.size=void 0,this.iconPack=o.d,this.t=(0,r.u)(),this.now=new Date,this.showLatestMessageButton=!1}connectedCallback(){var e;this.lastReadTimestamp=null!==(e=d.c.everyone)&&void 0!==e?e:new Date("0001-01-01T00:00:00Z"),this.intersectionObserver=new IntersectionObserver((e=>{document.hasFocus()&&(0,n.w)((()=>{for(const t of e)if(t.isIntersecting){parseInt(t.target.getAttribute("data-timestamp"))>this.lastReadTimestamp.getTime()&&(d.c[this.selectedGroup]=new Date)}}))}));const t=()=>{this.now=new Date,this.timeout=setTimeout((()=>{null!=this.request&&(this.request=requestAnimationFrame(t))}),6e4)};this.request=requestAnimationFrame(t),this.chatChanged(this.messages)}componentDidLoad(){this.$chat.addEventListener("scroll",this.onScroll),this.$chat.scrollTop=this.$chat.scrollHeight}componentDidRender(){this.autoScrollEnabled?(0,g.s)(this.$chat):null==this.autoScrollEnabled&&(0,g.s)(this.$chat,!1)}chatChanged(e){if(null!=this.$chat&&!this.autoScrollEnabled&&this.$chat.clientHeight!==this.$chat.scrollHeight)for(let t=e.length-1;t>=0;t--)if(e[t].message.time>this.lastReadTimestamp&&e[t].message.userId!==this.selfUserId){this.showLatestMessageButton=!0;break}}selectedBucketChanged(){this.autoScrollEnabled=void 0,this.observingEl.forEach((e=>{this.intersectionObserver.unobserve(e)})),this.observingEl=[]}disconnectedCallback(){this.$chat.removeEventListener("scroll",this.onScroll),this.intersectionObserver.disconnect(),clearTimeout(this.timeout),cancelAnimationFrame(this.request)}render(){var e;let t=null,i=!1;return(0,n.h)(n.H,null,(0,n.h)("div",{class:"chat-container scrollbar",ref:e=>this.$chat=e,part:"container"},(0,n.h)("div",{class:"spacer",part:"spacer"}),(0,n.h)("div",{class:"chat",part:"chat"},null===(e=this.messages)||void 0===e?void 0:e.map((e=>{if("chat"===e.type){const{message:s}=e,o=!(s.userId===this.selfUserId)&&!this.autoScrollEnabled&&!i&&s.time>this.lastReadTimestamp;o&&(i=o);const r=!o&&s.userId===(null==t?void 0:t.userId)&&(0,h.d)(s.time,null==t?void 0:t.time)<2;return t=s,(0,n.h)("div",{"is-continued":r,key:e.message.id,ref:this.observeMessage,"data-timestamp":s.time.getTime(),class:s.pinned?"pinned":""},o&&(0,n.h)("div",{class:"new-chat-marker",part:"new-chat-marker"},this.t("chat.new")),(0,n.h)("div",{class:"message-wrapper"},(0,n.h)("dyte-message-view",{time:s.time,actions:this.getMessageActions(s),authorName:s.displayName,hideAvatar:!0,hideAuthorName:!0,hideMetadata:!0,viewType:"incoming",variant:"plain",onAction:e=>this.onMessageActionHandler(e.detail,s)},(0,n.h)("div",null,!r&&(0,n.h)("div",{class:"head"},(0,n.h)("div",{class:"name"},s.displayName),!!s.time&&(0,n.h)("div",{class:"time",title:(0,h.f)(s.time)},(0,h.e)(s.time,new Date(Date.now())))),(0,n.h)("div",{class:"body"},"text"===s.type&&(0,n.h)("dyte-text-message-view",{text:s.message,isMarkdown:!0}),"file"===s.type&&(0,n.h)("dyte-file-message-view",{name:s.name,url:s.link,size:s.size}),"image"===s.type&&(0,n.h)("dyte-image-message-view",{url:s.link,onPreview:()=>{this.stateUpdate.emit({image:s}),a.s.image=s}})))),s.pinned&&(0,n.h)("div",{class:"pin-button",part:"pin-button"},(0,n.h)("dyte-tooltip",{label:this.t("unpin"),iconPack:this.iconPack,t:this.t},(0,n.h)("dyte-button",{kind:"icon",variant:"ghost",onClick:()=>this.onMessageActionHandler("pin_message",s),iconPack:this.iconPack,t:this.t,disabled:!this.canPinMessages},(0,n.h)("dyte-icon",{icon:this.iconPack.pin,iconPack:this.iconPack,t:this.t,size:"sm"}))))))}return null})))),(0,n.h)("div",{class:"show-new-messages-ctr"},(0,n.h)("dyte-button",{class:{"show-new-messages":!0,active:this.showLatestMessageButton},kind:"icon",part:"show-new-messages",onClick:this.scrollToBottom,iconPack:this.iconPack,t:this.t},(0,n.h)("dyte-icon",{icon:this.iconPack.chevron_down,iconPack:this.iconPack,t:this.t}))))}static get watchers(){return{messages:["chatChanged"],selectedGroup:["selectedBucketChanged"]}}};x.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}.scrollbar{scrollbar-width:thin;scrollbar-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))\n    var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar{height:var(--dyte-space-1\\.5, 6px);width:var(--dyte-space-1\\.5, 6px);border-radius:9999px;background-color:var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar-thumb{border-radius:9999px;background-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))}:host{position:relative;display:flex;flex-direction:column;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));word-break:break-word}.chat-container{box-sizing:border-box;display:flex;flex-direction:column;padding-top:var(--dyte-space-4, 16px);padding-bottom:var(--dyte-space-4, 16px);flex:1 0 0px;overflow-y:scroll}.chat-container .spacer{flex:1 1 auto}.chat-container .chat{flex:0 0 auto}.file-picker{display:none}.chat .head{display:flex;align-items:center}.chat .head .name{margin-right:var(--dyte-space-4, 16px);font-size:12px;font-weight:700}.chat .head .time{font-size:12px;color:rgb(var(--dyte-colors-text-800, 255 255 255 / 0.76))}.chat .body{margin-top:var(--dyte-space-2, 8px);overflow-wrap:break-word;line-height:1.375}.chat .body .emoji{font-size:24px}p{margin-top:var(--dyte-space-0, 0px);margin-bottom:var(--dyte-space-3, 12px)}dyte-message-view{margin-top:var(--dyte-space-4, 16px);display:block;padding-left:var(--dyte-space-2, 8px);padding-right:var(--dyte-space-2, 8px);color:rgb(var(--dyte-colors-text-900, 255 255 255 / 0.88));box-sizing:border-box}dyte-message-view::part(message){flex-grow:1}*[is-continued] dyte-message-view{margin-top:var(--dyte-space-1, 4px)}.pinned .message-wrapper{position:relative}.pinned .pin-button{position:absolute;right:var(--dyte-space-4, 16px);top:calc(var(--dyte-space-4, 16px) * -1);display:flex;border-radius:var(--dyte-border-radius-sm, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity))}.pinned .pin-button:hover dyte-button{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-600, 13 81 253) / var(--tw-bg-opacity))}.pinned dyte-message-view{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity));padding-top:var(--dyte-space-1, 4px);padding-bottom:var(--dyte-space-1, 4px)}a{--tw-text-opacity:1;color:rgba(var(--dyte-colors-brand-300, 73 124 253) / var(--tw-text-opacity));-webkit-text-decoration-line:none;text-decoration-line:none}a:hover{-webkit-text-decoration-line:underline;text-decoration-line:underline}.new-chat-marker{display:flex;width:100%;align-items:center;gap:var(--dyte-space-2, 8px);--tw-text-opacity:1;color:rgba(var(--dyte-colors-brand-300, 73 124 253) / var(--tw-text-opacity))}.new-chat-marker::before{content:'';height:1px;flex:1 1 0%;background-color:rgba(var(--dyte-colors-brand-300, 73 124 253) / 0.5)}.show-new-messages-ctr{pointer-events:none;display:flex;justify-content:flex-end;padding:var(--dyte-space-3, 12px);z-index:0;margin-top:calc(var(--dyte-space-14, 56px) * -1)}.show-new-messages{pointer-events:auto;--tw-translate-y:var(--dyte-space-16, 64px);transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));opacity:0;transition-property:color, background-color, border-color, fill, stroke, opacity, box-shadow, transform, filter, -webkit-text-decoration-color, -webkit-backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter, -webkit-text-decoration-color, -webkit-backdrop-filter;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.show-new-messages.active{--tw-translate-y:var(--dyte-space-0, 0px);transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));opacity:1}";const k=class{constructor(e){(0,n.r)(this,e),this.editMessageInit=(0,n.c)(this,"editMessageInit",7),this.pageSize=25,this.lastReadMessageIndex=-1,this.hasChildren=(e,t)=>{if(!this.children)return null;const i=this.children.cloneNode(!0);return i.message=e,i.isContinued=t,(0,n.h)("div",{ref:e=>e.appendChild(i)})},this.maybeMarkChannelAsRead=e=>{if(!this.selectedChannelId)return;if(0===e.length)return;if(-1!==this.lastReadMessageIndex)return;const t=e.at(0).time>e.at(-1).time?e.at(0):e.at(-1);t.channelIndex&&(this.lastReadMessageIndex=parseInt(t.channelIndex,10),this.meeting.chat.markLastReadMessage(this.selectedChannelId,t))},this.getChatMessages=async(e,t,i)=>{const{messages:n}=await this.meeting.chat.getMessages(e,t,i,void 0,this.selectedChannelId);return this.maybeMarkChannelAsRead(n),n},this.createChatNodes=e=>e.map(((t,i)=>{var n;const a=t.userId===(null===(n=e[i-1])||void 0===n?void 0:n.userId);return this.createChatNode(t,a)})),this.disconnectMeeting=e=>{var t;null===(t=null==e?void 0:e.chat)||void 0===t||t.removeListener("chatUpdate",this.chatUpdateListener)},this.createChatNode=(e,t)=>{var i,a,s;const o=this.meeting.self.userId===e.userId,r=null===(i=this.meeting.self.permissions)||void 0===i?void 0:i.chatMessage,d=void 0===r?o:"ALL"===r.canEdit||"SELF"===r.canEdit&&o,c=void 0===r?o:"ALL"===r.canDelete||"SELF"===r.canDelete&&o;return(0,n.h)("dyte-chat-message",{leftAlign:this.leftAlign,message:e,isContinued:t,isUnread:!1,size:this.size,iconPack:this.iconPack,key:e.id,isSelf:o,alignRight:o&&"CHAT"===this.meeting.meta.viewType,disableControls:"CHAT"!==this.meeting.meta.viewType,senderDisplayPicture:null===(a=this.meeting.participants.all.toArray().find((t=>t.userId===e.userId)))||void 0===a?void 0:a.picture,hideAvatar:o&&"CHAT"===this.meeting.meta.viewType||(null===(s=this.selectedChannel)||void 0===s?void 0:s.isDirectMessage),canEdit:d&&"text"===e.type,canDelete:c,canReply:"text"===e.type,onEdit:()=>{"text"===e.type&&this.editMessageInit.emit({payload:e,flags:{isEdit:!0}})},onReply:()=>{"text"===e.type&&this.editMessageInit.emit({payload:e,flags:{isReply:!0}})},onDelete:async()=>{var t;await this.meeting.chat.deleteMessage(e.id,null===(t=this.selectedChannel)||void 0===t?void 0:t.id).catch((()=>{}))}},this.hasChildren(e,t))},this.chatUpdateListener=e=>{this.selectedChannelId&&e.message.channelId!==this.selectedChannelId||("add"===e.action?(this.$paginatedListRef.onNewNode(e.message),this.lastReadMessageIndex=-1,this.maybeMarkChannelAsRead([e.message])):"delete"===e.action?this.$paginatedListRef.onNodeDelete(e.message.id):"edit"===e.action&&this.$paginatedListRef.onNodeUpdate(e.message.id,e.message))},this.meeting=void 0,this.selectedChannel=void 0,this.selectedChannelId=void 0,this.size=void 0,this.iconPack=o.d,this.t=(0,r.u)(),this.children=void 0,this.leftAlign=!1}componentDidLoad(){const e=this.host.shadowRoot.querySelector("slot");e&&(this.children=e.assignedElements()[0])}connectedCallback(){this.meetingChanged(this.meeting)}disconnectedCallback(){this.disconnectMeeting(this.meeting)}meetingChanged(e,t){var i;null!=t&&this.disconnectMeeting(t),e&&!e.chat||null!=e&&(null===(i=e.chat)||void 0===i||i.addListener("chatUpdate",this.chatUpdateListener))}channelChanged(){this.lastReadMessageIndex=-1}render(){return(0,n.h)(n.H,null,(0,n.h)("dyte-paginated-list",{ref:e=>this.$paginatedListRef=e,pageSize:this.pageSize,pagesAllowed:3,fetchData:this.getChatMessages,createNodes:this.createChatNodes,selectedItemId:this.selectedChannelId,emptyListLabel:this.t("chat.empty_channel")},(0,n.h)("slot",null)))}get host(){return(0,n.a)(this)}static get watchers(){return{meeting:["meetingChanged"],selectedChannelId:["channelChanged"]}}};k.style=":host{display:flex;flex-direction:column;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-1000, 8 8 8) / var(--tw-bg-opacity));flex:1 0 0px}";const _=class{constructor(e){(0,n.r)(this,e),this.pageSize=50,this.searchMessages=async(e,t,i)=>this.meeting.chat.searchMessages(this.query,{channelId:this.channelId,timestamp:e,size:t,reversed:i}),this.nodeRenderer=e=>e.map((e=>(0,n.h)("dyte-chat-message",{key:e.id,message:e,disableControls:!0}))),this.meeting=void 0,this.query=void 0,this.channelId=void 0,this.iconPack=o.d,this.t=(0,r.u)()}render(){return(0,n.h)(n.H,null,(0,n.h)("dyte-paginated-list",{pageSize:this.pageSize,pagesAllowed:3,fetchData:this.searchMessages,createNodes:this.nodeRenderer,selectedItemId:this.query}))}};_.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{display:flex;height:100%;flex-direction:column;position:relative;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity))}";const C=class{constructor(e){(0,n.r)(this,e),this.stateUpdate=(0,n.c)(this,"dyteStateUpdate",7),this.updateStoreState=(e,t)=>{a.s[e]=t,this.stateUpdate.emit({[e]:t})},this.cancelJoinStage=async()=>{var e,t,i;"ACCEPTED_TO_JOIN_STAGE"===(null===(e=this.meeting.stage)||void 0===e?void 0:e.status)&&await(null===(i=null===(t=this.meeting)||void 0===t?void 0:t.stage)||void 0===i?void 0:i.leave()),this.updateStoreState("activeJoinStage",!1)},this.joinStage=async()=>{await this.meeting.stage.join()},this.stageStatusUpdateListener=e=>{var t;((null===(t=this.states)||void 0===t?void 0:t.activeJoinStage)||a.s.activeJoinStage)&&"ON_STAGE"===e&&this.updateStoreState("activeJoinStage",!1)},this.meeting=void 0,this.config=p.d,this.states=a.s,this.size=void 0,this.iconPack=o.d,this.t=(0,r.u)()}connectedCallback(){this.meetingChanged(this.meeting)}disconnectedCallback(){var e;null===(e=this.meeting.stage)||void 0===e||e.removeListener("stageStatusUpdate",this.stageStatusUpdateListener)}meetingChanged(e){if(null==e)return;const{stage:t}=e;null==t||t.addListener("stageStatusUpdate",this.stageStatusUpdateListener)}render(){var e,t,i,s;const o={meeting:this.meeting,states:this.states||a.s,config:this.config,size:this.size,iconPack:this.iconPack,t:this.t},r=this.states||a.s;if(null!=(null==r?void 0:r.image)){const e=r.image,t=()=>{this.stateUpdate.emit({image:null}),a.s.image=null};return(0,n.h)(n.H,null,(0,n.h)("dyte-dialog",{open:!0,onDyteDialogClose:t,hideCloseButton:!0,iconPack:this.iconPack,t:this.t},(0,n.h)(u.R,{element:"dyte-image-viewer",defaults:o,props:{image:e,onClose:t}})))}if(!0===(null==r?void 0:r.activeSettings))return(0,n.h)(n.H,null,(0,n.h)("dyte-dialog",{open:!0,onDyteDialogClose:()=>this.updateStoreState("activeSettings",!1),iconPack:this.iconPack,t:this.t},(0,n.h)(u.R,{element:"dyte-settings",defaults:o})));if(!0===(null==r?void 0:r.activeDebugger))return(0,n.h)(n.H,null,(0,n.h)("dyte-dialog",{open:!0,onDyteDialogClose:()=>this.updateStoreState("activeDebugger",!1),iconPack:this.iconPack,t:this.t},(0,n.h)(u.R,{element:"dyte-debugger",defaults:o})));if(!0===(null==r?void 0:r.activeLeaveConfirmation))return(0,n.h)(n.H,null,(0,n.h)("dyte-dialog",{open:!0,onDyteDialogClose:()=>this.updateStoreState("activeLeaveConfirmation",!1),iconPack:this.iconPack,t:this.t},(0,n.h)(u.R,{element:"dyte-leave-meeting",defaults:o})));if(!0===(null===(e=null==r?void 0:r.activePermissionsMessage)||void 0===e?void 0:e.enabled))return(0,n.h)(n.H,null,(0,n.h)("dyte-dialog",{open:!0,onDyteDialogClose:()=>this.updateStoreState("activePermissionsMessage",{enabled:!1}),iconPack:this.iconPack,t:this.t},(0,n.h)(u.R,{element:"dyte-permissions-message",defaults:o})));if(!0===(null==r?void 0:r.activeRemoteAccessManager))return(0,n.h)(n.H,null,(0,n.h)("dyte-dialog",{open:!0,onDyteDialogClose:()=>this.updateStoreState("activeRemoteAccessManager",!1),iconPack:this.iconPack,t:this.t},(0,n.h)(u.R,{element:"dyte-remote-access-manager",defaults:o})));if(!0===(null===(t=null==r?void 0:r.activeBreakoutRoomsManager)||void 0===t?void 0:t.active))return(0,n.h)(n.H,null,(0,n.h)("dyte-dialog",{open:!0,onDyteDialogClose:()=>this.updateStoreState("activeBreakoutRoomsManager",{active:!1,data:void 0}),iconPack:this.iconPack,t:this.t},(0,n.h)(u.R,{element:"dyte-breakout-rooms-manager",defaults:o,props:{mode:this.meeting.connectedMeetings.isActive?"view":"create"}})));if(!0===(null===(i=null==r?void 0:r.activeConfirmationModal)||void 0===i?void 0:i.active))return(0,n.h)(n.H,null,(0,n.h)("dyte-dialog",{open:!0,onDyteDialogClose:()=>this.updateStoreState("activeConfirmationModal",!1),iconPack:this.iconPack,t:this.t},(0,n.h)(u.R,{element:"dyte-confirmation-modal",defaults:o})));if(!0===(null===(s=null==r?void 0:r.activeOverlayModal)||void 0===s?void 0:s.active))return(0,n.h)(n.H,null,(0,n.h)("dyte-overlay-modal",{meeting:this.meeting,states:this.states,iconPack:this.iconPack,t:this.t}));if(null==r?void 0:r.activeBroadcastMessageModal)return(0,n.h)(n.H,null,(0,n.h)("dyte-dialog",{open:!0,onDyteDialogClose:()=>this.updateStoreState("activeBroadcastMessageModal",!1),iconPack:this.iconPack,t:this.t},(0,n.h)(u.R,{element:"dyte-broadcast-message-modal",defaults:o})));if(!0===(null==r?void 0:r.activeJoinStage)){const e={title:this.t("stage.join_title"),label:{accept:this.t("stage.join_confirm"),reject:this.t("stage.join_cancel")},description:this.t("stage.join_summary")};return(0,n.h)(n.H,null,(0,n.h)("dyte-dialog",{open:!0,onDyteDialogClose:this.cancelJoinStage,iconPack:this.iconPack,t:this.t},(0,n.h)("dyte-join-stage",Object.assign({dataConfig:e,onDyteJoinStage:this.joinStage,onDyteLeaveStage:this.cancelJoinStage},o))))}return!0===(null==r?void 0:r.activeMuteAllConfirmation)?(0,n.h)(n.H,null,(0,n.h)("dyte-dialog",{open:!0,onDyteDialogClose:()=>{this.updateStoreState("activeMuteAllConfirmation",!1)},iconPack:this.iconPack,t:this.t},(0,n.h)(u.R,{element:"dyte-mute-all-confirmation",defaults:o}))):(null==r?void 0:r.activeChannelCreator)?(0,n.h)(n.H,null,(0,n.h)("dyte-dialog",{open:!0,onDyteDialogClose:()=>{this.updateStoreState("activeChannelCreator",!1)},iconPack:this.iconPack,t:this.t},(0,n.h)(u.R,{element:"dyte-channel-creator",defaults:o}))):null}static get watchers(){return{meeting:["meetingChanged"]}}};C.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{display:block}";const S=2e3,P=Object.freeze({notifications:{participant_joined:!0,participant_left:!0,participant_joined_waitlist:!0,chat:!0,polls:!0,webinar:!0,tab_sync:!0,recording_started:!0,recording_stopped:!0},notification_sounds:{participant_joined:!0,participant_left:!0,chat:!0,polls:!0,webinar:!0,participant_joined_waitlist:!0},notification_duration:{participant_joined:2100,participant_left:2100,participant_joined_waitlist:4e3,chat:S,polls:S,webinar:S,tab_sync:S,recording_started:S,recording_stopped:S},participant_joined_sound_notification_limit:10,participant_chat_message_sound_notification_limit:10});function L(e){return Object.keys(e).filter((t=>e[t]))}const j=class{constructor(e){(0,n.r)(this,e),this.permissions=P,this.enabledSounds=L(P.notification_sounds),this.addStagePeersListeners=e=>{e.participants.joined.addListener("participantJoined",this.participantJoinedListener),e.meta.addListener("disconnected",this.networkDisconnectedListener),e.meta.addListener("connected",this.networkConnectedListener),e.participants.joined.addListener("participantLeft",this.participantLeftListener)},this.removeStagePeersListeners=e=>{e.participants.joined.removeListener("participantJoined",this.participantJoinedListener),e.meta.removeListener("disconnected",this.networkDisconnectedListener),e.meta.removeListener("connected",this.networkConnectedListener),e.participants.joined.removeListener("participantLeft",this.participantLeftListener)},this.onRemoteUpdate=({payload:e,type:t})=>{if(t===m.R.INCOMING_REQUEST_ACCEPTED){let t=this.meeting.participants.joined.get(e.request.remotePeerId);this.add({id:`message-${Math.random().toString(36)}`,icon:this.iconPack.chat,message:`Granted remote control to ${t.name}`,duration:S})}if(t===m.R.OUTGOING_REQUEST_ACCEPTED){let t=this.meeting.participants.joined.get(e.request.hostPeerId);this.add({id:`message-${Math.random().toString(36)}`,icon:this.iconPack.chat,message:`${t.name} has granted remote control.`,duration:S})}if(t===m.R.REQUEST_RECEIVED){let t=this.meeting.participants.joined.get(e.request.remotePeerId);this.add({id:`message-${Math.random().toString(36)}`,icon:this.iconPack.chat,message:`${t.name} has requested for remote control.`,duration:S})}if(t!==m.R.INCOMING_REQUEST_ENDED&&t!==m.R.OUTGOING_REQUEST_ENDED||this.add({id:`message-${Math.random().toString(36)}`,icon:this.iconPack.chat,message:"Existing remote control has been terminated.",duration:S}),t===m.R.REQUEST_SENT){let t=this.meeting.participants.joined.get(e.request.hostPeerId);this.add({id:`message-${Math.random().toString(36)}`,icon:this.iconPack.chat,message:`Sent remote control request to ${t.name}`,duration:S})}},this.onDyteNotification=e=>{this.add(e.detail);const t=e.detail.playSound;null!=t&&this.audio.play(t)},this.onRecordingUpdate=e=>{var t,i;"RECORDING"===e&&!1!==this.permissions.notifications.recording_started?this.add({id:"recording-started",icon:this.iconPack.recording,message:this.t("recording.started"),duration:null!==(t=this.permissions.notification_duration.recording_started)&&void 0!==t?t:S}):"STOPPING"===e&&!1!==this.permissions.notifications.recording_stopped&&this.add({id:"recording-stopped",icon:this.iconPack.stop_recording,message:this.t("recording.stopped"),duration:null!==(i=this.permissions.notification_duration.recording_stopped)&&void 0!==i?i:S})},this.meeting=void 0,this.states=void 0,this.config=p.d,this.t=(0,r.u)(),this.size=void 0,this.iconPack=o.d,this.notifications=[]}connectedCallback(){"undefined"!=typeof document&&(null===document||void 0===document||document.addEventListener("dyteNotification",this.onDyteNotification)),this.meetingChanged(this.meeting),this.configChanged(this.config),this.statesChanged(this.states)}clearListeners(e){var t,i,n,a,s,o,r,d,c;const l="LIVESTREAM"===e.meta.viewType;(l&&"ON_STAGE"===(null===(t=e.stage)||void 0===t?void 0:t.status)||!l)&&this.removeStagePeersListeners(e),this.chatUpdateListener&&(null===(i=e.chat)||void 0===i||i.removeListener("chatUpdate",this.chatUpdateListener)),this.pollUpdateListener&&(null===(n=e.polls)||void 0===n||n.removeListener("pollsUpdate",this.pollUpdateListener)),this.socketDisconnectedListener&&e.meta.removeListener("socketDisconnected",this.socketDisconnectedListener),this.socketReconnectFailureListener&&e.meta.removeListener("socketReconnectFailure",this.socketReconnectFailureListener),this.socketReconnectedListener&&e.meta.removeListener("socketReconnected",this.socketReconnectedListener),this.socketReconnectingListener&&e.meta.removeListener("socketReconnecting",this.socketReconnectingListener),this.socketFailureListener&&e.meta.removeListener("socketFailure",this.socketFailureListener),this.stageRequestAccepted&&(null===(a=e.stage)||void 0===a||a.removeListener("stageRequestApproved",this.stageRequestAccepted)),this.stageRequestRejected&&(null===(s=e.stage)||void 0===s||s.removeListener("stageRequestRejected",this.stageRequestRejected)),this.newStageRequests&&(null===(o=e.stage)||void 0===o||o.removeListener("newStageRequest",this.newStageRequests)),this.stageStatusUpdateListener&&(null===(r=e.stage)||void 0===r||r.removeListener("stageStatusUpdate",this.stageStatusUpdateListener)),null===(d=e.remote)||void 0===d||d.removeListener("remoteUpdate",this.onRemoteUpdate),null===(c=e.recording)||void 0===c||c.removeListener("recordingUpdate",this.onRecordingUpdate),clearTimeout(this.disconnectTimeout),e.self.removeListener("deviceUpdate",this.deviceUpdateListener)}disconnectedCallback(){var e;"undefined"!=typeof document&&(null===document||void 0===document||document.removeEventListener("dyteNotification",this.onDyteNotification)),null!=this.meeting&&(this.clearListeners(this.meeting),this.waitlistedParticipantJoinedListener&&this.meeting.participants.waitlisted.removeListener("participantJoined",this.waitlistedParticipantJoinedListener),this.activeTabUpdateListener&&(null===(e=this.meeting.meta)||void 0===e||e.removeListener("activeTabUpdate",this.activeTabUpdateListener)),this.peerStageStatusListener&&this.meeting.participants.joined.removeListener("stageStatusUpdate",this.peerStageStatusListener))}meetingChanged(e,t){var i,n,a,o,r,d,c,h,g;if(clearTimeout(this.disconnectTimeout),void 0!==t&&this.clearListeners(t),null==e)return;const p="LIVESTREAM"===e.meta.viewType;this.audio=new y.D(e);const{notifications:u,notification_duration:m,notification_sounds:b}=this.permissions;if(this.participantJoinedListener=e=>{u.participant_joined&&this.add({id:`${e.id}-joined`,message:`${(0,v.f)(e.name)} just joined`,image:e.picture,duration:m.participant_joined}),b.participant_joined&&this.canPlayParticipantJoinedSound()&&this.audio.play("joined")},this.participantLeftListener=e=>{u.participant_left&&this.add({id:`${e.id}-left`,message:`${(0,v.f)(e.name)} left`,image:e.picture,duration:m.participant_left}),b.participant_left&&this.canPlayParticipantJoinedSound()&&this.audio.play("left")},this.waitlistedParticipantJoinedListener=e=>{const t=`${e.id}-joined-waitlist`;this.add({id:t,message:`${(0,v.f)(e.name)} is requesting to join the meeting`,image:e.picture,duration:m.participant_joined_waitlist,button:{text:"Accept",variant:"secondary",onClick:async()=>{await this.meeting.participants.acceptWaitingRoomRequest(e.id),this.remove(t)}}}),b.participant_joined_waitlist&&this.canPlayParticipantJoinedSound()&&this.audio.play("message")},this.chatUpdateListener=({message:t})=>{const i=(0,l.j)(t);if(null!=i){if(i.userId===e.self.userId)return;"text"===i.type&&(u.chat&&this.add({id:`message-${Math.random().toString(36)}`,icon:this.iconPack.chat,message:`${i.displayName}: ${i.message}`,duration:m.chat}),b.chat&&this.canPlayChatSound()&&this.audio.play("message"))}},this.pollUpdateListener=({polls:e,newPoll:t})=>{!1!==t&&(u.polls&&this.meeting.self.userId!==e[e.length-1].createdByUserId&&this.add({id:`poll-${Math.random().toString(36)}`,icon:this.iconPack.poll,message:`New poll created by ${e[e.length-1].createdBy}`,duration:m.polls}),b.polls&&this.meeting.self.userId!==e[e.length-1].createdByUserId&&this.canPlayChatSound()&&this.audio.play("message"))},this.deviceUpdateListener=({device:e,preview:t})=>{t||("audiooutput"===e.kind?(this.audio.setDevice(e.deviceId),this.add({id:`speaker-switched-${e.deviceId}`,message:`Connected to ${e.label}`,icon:this.iconPack.speaker,duration:5e3})):"videoinput"===e.kind?this.add({id:`camera-switched-${e.deviceId}`,message:`Connected to ${e.label}`,icon:this.iconPack.speaker,duration:5e3}):this.add({id:`mic-switched-${e.deviceId}`,message:`Connected to ${e.label}`,icon:this.iconPack.mic_on,duration:5e3}))},this.networkDisconnectedListener=()=>{let e;this.remove("network"),e=2e4,this.add({id:"network",icon:this.iconPack.disconnected,message:this.t("network.reconnecting"),duration:2e4}),this.disconnectTimeout=setTimeout((()=>{this.add({id:"network-lost",icon:this.iconPack.disconnected,message:this.t("network.delay"),button:{text:this.t("end"),variant:"danger",onClick:()=>{var e;return null===(e=this.meeting)||void 0===e?void 0:e.leaveRoom()}}})}),2e4)},this.networkConnectedListener=()=>{let e;this.remove("network"),this.remove("network-lost"),e=3e3,this.add({id:"network",icon:this.iconPack.wifi,message:this.t("network.restored"),duration:3e3}),clearTimeout(this.disconnectTimeout)},this.socketUpdateListener=({event:e,attempt:t})=>{this.remove("socket"),"reconnected"===e?(this.remove("socketReconnecting"),this.add({id:"socket",icon:this.iconPack.wifi,message:this.t("network.restored"),duration:3e3})):"disconnected"===e?this.add({id:"socket",icon:this.iconPack.disconnected,message:this.t("network.lost"),duration:3e3}):"reconnecting"===e?this.add({id:"socketReconnecting",icon:this.iconPack.disconnected,message:this.t("network.lost_extended")}):"reconnectFailure"===e?t>5&&(this.remove("socketReconnecting"),this.add({id:"socketReconnecting",icon:this.iconPack.disconnected,message:this.t("network.delay_extended"),button:{text:this.t("end"),variant:"danger",onClick:()=>{var e;return null===(e=this.meeting)||void 0===e?void 0:e.leaveRoom()}}})):"failed"===e&&(this.remove("socketReconnecting"),this.add({id:"socketFailed",icon:this.iconPack.disconnected,message:this.t("network.disconnected")}),this.add({id:"leaveMeeting",icon:this.iconPack.warning,message:this.t("network.leaving")}),setTimeout((()=>{var e;null===(e=this.meeting)||void 0===e||e.leaveRoom("disconnected")}),1e4))},this.activeTabUpdateListener=t=>{if(u.tab_sync)switch(t.type){case"plugin":const i=e.plugins.active.toArray().find((e=>e.id==t.id));null!=i&&this.add({id:"activeTab",message:`Plugin switched to ${i.name}`,duration:m.participant_joined});break;case"screenshare":const n=e.participants.joined.toArray().filter((e=>e.screenShareEnabled)).find((e=>e.id==t.id));null!=n&&this.add({id:"spotlight",message:`Now watching ${n.name}'s screen`,duration:m.webinar})}},this.peerStageStatusListener=e=>{"REQUESTED_TO_JOIN_STAGE"===e.stageStatus&&(this.add({id:`stage-request-${e.id}`,message:`${e.name} has requested to join stage`,duration:m.webinar,button:{text:"Accept",variant:"primary",onClick:async()=>{await this.meeting.stage.grantAccess([e.userId]),this.remove(`stage-request-${e.id}`)}}}),b.webinar&&this.audio.play("joined")),"ON_STAGE"===e.stageStatus&&(this.add({id:`stage-joined-${e.id}`,message:`${e.name} has joined stage`,duration:m.webinar}),b.webinar&&this.audio.play("joined"))},this.stageRequestAccepted=()=>{this.add({id:"stage-request-accepted",message:"Request to join accepted",duration:3e3})},this.stageRequestRejected=()=>{this.add({id:"stage-request-rejected",message:"Request to join rejected",duration:3e3})},this.newStageRequests=({count:e})=>{this.add({id:"new-stage-request",message:`You have ${e<0?"new stage":`${e} pending`} request${1===e?"":"s"}`,duration:3e3})},this.stageStatusUpdateListener=t=>{"ON_STAGE"===t?this.addStagePeersListeners(e):this.removeStagePeersListeners(e)},this.socketReconnectedListener=()=>this.socketUpdateListener({event:"reconnected"}),this.socketDisconnectedListener=()=>this.socketUpdateListener({event:"disconnected"}),this.socketReconnectingListener=()=>this.socketUpdateListener({event:"reconnecting"}),this.socketFailureListener=()=>this.socketUpdateListener({event:"failed"}),this.socketReconnectFailureListener=({attempt:e})=>this.socketUpdateListener({event:"reconnectFailure",attempt:e}),!(0,s.s)(e)&&(null===(i=e.chat)||void 0===i||i.addListener("chatUpdate",this.chatUpdateListener)),"CHAT"===e.self.config.viewType)return;const f=e.self.getCurrentDevices();null!=f.speaker&&this.audio.setDevice(f.speaker.deviceId),p?null===(n=e.stage)||void 0===n||n.on("stageStatusUpdate",this.stageStatusUpdateListener):this.addStagePeersListeners(e),this.canAcceptWaitingRequests()&&e.participants.waitlisted.addListener("participantJoined",this.waitlistedParticipantJoinedListener),null===(a=e.polls)||void 0===a||a.addListener("pollsUpdate",this.pollUpdateListener),e.self.addListener("deviceUpdate",this.deviceUpdateListener),e.meta.addListener("socketReconnected",this.socketReconnectedListener),e.meta.addListener("socketDisconnected",this.socketDisconnectedListener),e.meta.addListener("socketReconnecting",this.socketReconnectingListener),e.meta.addListener("socketFailure",this.socketFailureListener),e.meta.addListener("socketReconnectFailure",this.socketReconnectFailureListener),null===(o=e.remote)||void 0===o||o.addListener("remoteUpdate",this.onRemoteUpdate),null===(r=e.meta)||void 0===r||r.addListener("activeTabUpdate",this.activeTabUpdateListener),null===(d=e.recording)||void 0===d||d.addListener("recordingUpdate",this.onRecordingUpdate),null===(c=e.stage)||void 0===c||c.addListener("stageRequestApproved",this.stageRequestAccepted),null===(h=e.stage)||void 0===h||h.addListener("stageRequestRejected",this.stageRequestRejected),e.self.permissions.stageEnabled&&e.self.permissions.acceptStageRequests&&(null===(g=e.stage)||void 0===g||g.addListener("newStageRequest",this.newStageRequests))}configChanged(e){null!=e&&null!=(null==e?void 0:e.config)&&(this.permissions=function(e){const t=Object.assign({},P);return null==e||(Object.assign(t.notification_sounds,e.notification_sounds),Object.assign(t.notifications,e.notifications),Object.assign(t.notification_duration,e.notification_duration),t.participant_chat_message_sound_notification_limit=e.participant_chat_message_sound_notification_limit,t.participant_joined_sound_notification_limit=e.participant_joined_sound_notification_limit),t}(e.config),this.enabledSounds=L(this.permissions.notification_sounds))}statesChanged(e){var t;if(null!=e){const i=!(null===(t=null==e?void 0:e.prefs)||void 0===t?void 0:t.muteNotificationSounds);for(const e of this.enabledSounds)e in this.permissions.notification_sounds&&(this.permissions.notification_sounds[e]=i)}}apiErrorListener({detail:e}){const{trace:t,message:i}=e;this.add({id:t,message:i,duration:S,icon:this.iconPack.warning})}sendNotificationListener({detail:e}){const{trace:t,message:i}=e;this.add({id:t,message:i,duration:S})}add(e){"visible"===document.visibilityState&&this.notifications.length<5&&(this.notifications=[...this.notifications,e])}remove(e){this.notifications=this.notifications.filter((t=>t.id!==e))}handleDismiss(e){e.stopPropagation();const t=e.detail,i=this.host.shadowRoot.querySelector(`[data-id="${t}"]`);null==i||i.classList.add("exit"),setTimeout((()=>{(0,n.w)((()=>{this.remove(t)}))}),400)}canPlayParticipantJoinedSound(){return null==this.permissions.participant_joined_sound_notification_limit||this.permissions.participant_joined_sound_notification_limit<=0||this.meeting.participants.count<=this.permissions.participant_joined_sound_notification_limit}canPlayChatSound(){return null==this.permissions.participant_chat_message_sound_notification_limit||this.permissions.participant_chat_message_sound_notification_limit<=0||this.meeting.participants.count<=this.permissions.participant_chat_message_sound_notification_limit}canAcceptWaitingRequests(){return this.permissions.notifications.participant_joined_waitlist&&this.meeting.self.permissions.acceptWaitingRequests}render(){return(0,n.h)(n.H,null,this.notifications.map((e=>(0,n.h)("dyte-notification",{size:this.size,key:e.id,"data-id":e.id,notification:e,onDyteNotificationDismiss:e=>this.handleDismiss(e),iconPack:this.iconPack,t:this.t}))))}get host(){return(0,n.a)(this)}static get watchers(){return{meeting:["meetingChanged"],config:["configChanged"],states:["statesChanged"]}}};j.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{position:absolute;top:var(--dyte-space-4, 16px);right:var(--dyte-space-4, 16px);bottom:var(--dyte-space-4, 16px);left:var(--dyte-space-4, 16px);top:auto;display:flex;flex-direction:column;pointer-events:none;z-index:100}dyte-notification{margin-top:var(--dyte-space-2, 8px)}"},36766:(e,t,i)=>{var n;i.d(t,{R:()=>n}),function(e){e.REQUEST_RECEIVED="REQUEST_RECEIVED",e.REQUEST_SENT="REQUEST_SENT",e.INCOMING_REQUEST_ACCEPTED="INCOMING_REQUEST_ACCEPTED",e.OUTGOING_REQUEST_ACCEPTED="OUTGOING_REQUEST_ACCEPTED",e.INCOMING_REQUEST_ENDED="INCOMING_REQUEST_ENDED",e.OUTGOING_REQUEST_ENDED="OUTGOING_REQUEST_ENDED"}(n||(n={}))},17213:(e,t,i)=>{i.d(t,{R:()=>d,l:()=>r});var n=i(72944);const a=({element:e,size:t,states:i={},config:n={}})=>{let a=[];const s=null==n?void 0:n.root[e],o=e=>{a.push(e),"string"==typeof t&&a.push(`${e}.${t}`)};if(o(e),"object"==typeof s&&!Array.isArray(s)&&null!==s){const{state:t,states:n}=s;let a=e,r=[];if(Array.isArray(n)){r=n.filter((e=>i[e])),r.sort();for(const e of r)o(`${a}.${e}`);if(r.length>1){o([a,...r].join("."))}}if("string"==typeof t){const n=`${e}[${t}=${i[t]}]`;o(n);for(const e of r)o(`${n}.${e}`);if(r.length>1){o([n,...r].join("."))}}}return a},s=({selectors:e,root:t})=>{if(!t||!Array.isArray(e))return[];let i=[];for(const n of e){const e=t[n];if(Array.isArray(e))i=[...e];else if(e){if(e.children&&(i=[...e.children]),Array.isArray(e.remove))for(const t of e.remove)i=i.filter((e=>"string"==typeof e?e!==t:!Array.isArray(e)||e[0]!==t));if(e.addBefore)for(const[t,n]of Object.entries(e.addBefore)){const e=i.findIndex((e=>"string"==typeof e?e===t:!!Array.isArray(e)&&e[0]===t));e>=0&&i.splice(e,0,...n)}Array.isArray(e.add)&&(i=i.concat(e.add)),Array.isArray(e.prepend)&&(i=e.prepend.concat(i))}}return i},o=({elements:e,defaults:t,props:i={},deepProps:a=!1,elementProps:s={}})=>Array.isArray(e)&&0!==e.length?e.map((e=>(0,n.h)(d,{element:e,defaults:t,props:i,childProps:a&&i,elementProps:s}))):null,r=({element:e,defaults:t,props:i={},elementProps:n={}})=>{var o;const{config:r,size:d,states:c}=t;let l,h={},g=[];Array.isArray(e)?[l,h,...g]=e:l=e;const p=null===(o=null==r?void 0:r.root)||void 0===o?void 0:o[l];null!=p&&"props"in p&&(i=Object.assign(Object.assign({},p.props),i)),i=Object.assign(Object.assign({},i),h),l in n&&(i=Object.assign(Object.assign({},i),n[l]));const u=a({element:l,size:d,states:c,config:r});return s({selectors:u,root:r.root}).length},d=({element:e,defaults:t,childProps:i={},props:r={},onlyChildren:d=!1,asHost:c=!1,deepProps:l=!1,elementProps:h={}},g)=>{var p;const{config:u,size:m,states:y}=t;let v,b={},f=[];Array.isArray(e)?[v,b,...f]=e:v=e;const w=null===(p=null==u?void 0:u.root)||void 0===p?void 0:p[v];null!=w&&"props"in w&&(r=Object.assign(Object.assign({},w.props),r)),r=Object.assign(Object.assign({},r),b),v in h&&(r=Object.assign(Object.assign({},r),h[v]));const x=a({element:v,size:m,states:y,config:u}),k=s({selectors:x,root:u.root});if(d)return(0,n.h)(o,{elements:k,defaults:t,props:i,deepProps:l,elementProps:h});const _=(({selectors:e,styles:t})=>{if(!Array.isArray(e)||null==t)return{};const i={};for(const n of e){const e=t[n];null!=e&&Object.assign(i,e)}return i})({selectors:x,styles:u.styles});if(c)return(0,n.h)(n.H,Object.assign({},t,{style:_},r),(0,n.h)(o,{elements:k,defaults:t,props:i,deepProps:l,elementProps:h}),g,f.map((e=>{if(Array.isArray(e)){const[i,a]=e;return(0,n.h)(i,Object.assign({},t,a))}return e})));if(["dyte-header","dyte-controlbar"].includes(v)&&(r.disableRender=!0),v.startsWith("dyte-"))return(0,n.h)(v,Object.assign({},t,{style:_},r),(0,n.h)(o,{elements:k,defaults:t,props:i,deepProps:l,elementProps:h}),g,f.map((e=>{if(Array.isArray(e)){const[i,a]=e;return(0,n.h)(i,Object.assign({},t,a))}return e})));{const[e,a]=v.split("#");return(0,n.h)(e,Object.assign({id:a,style:_},r),(0,n.h)(o,{elements:k,defaults:t,props:i,deepProps:l,elementProps:h}),g,f.map((e=>{if(Array.isArray(e)){const[i,a]=e;return(0,n.h)(i,Object.assign({},t,a))}return e})))}}},49583:(e,t,i)=>{i.d(t,{S:()=>o,a:()=>y,b:()=>m,f:()=>n,i:()=>v,r:()=>s});var n="object"==typeof i.g&&i.g&&i.g.Object===Object&&i.g,a="object"==typeof self&&self&&self.Object===Object&&self,s=n||a||Function("return this")(),o=s.Symbol,r=Object.prototype,d=r.hasOwnProperty,c=r.toString,l=o?o.toStringTag:void 0;var h=Object.prototype.toString;var g="[object Null]",p="[object Undefined]",u=o?o.toStringTag:void 0;function m(e){return null==e?void 0===e?p:g:u&&u in Object(e)?function(e){var t=d.call(e,l),i=e[l];try{e[l]=void 0;var n=!0}catch(s){}var a=c.call(e);return n&&(t?e[l]=i:delete e[l]),a}(e):function(e){return h.call(e)}(e)}function y(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function v(e){return null!=e&&"object"==typeof e}},41960:(e,t,i)=>{i.d(t,{l:()=>n});const n=console},85872:(e,t,i)=>{i.d(t,{D:()=>o});var n=i(64383),a=i(41960);const s={joined:"https://dyte-uploads.s3.ap-south-1.amazonaws.com/notification_join.mp3",left:"https://dyte-uploads.s3.ap-south-1.amazonaws.com/notification_join.mp3",message:"https://dyte-uploads.s3.ap-south-1.amazonaws.com/notification_message.mp3"};class o{constructor(e){this.meeting=e,this.audio=document.createElement("audio"),this.audio.volume=.3}play(e,t=3e3){var i;this.playing||(this.playing=!0,this.audio.src=s[e],this.audio.volume=.3,null===(i=this.audio.play())||void 0===i||i.catch((i=>{a.l.error("[dyte-notifications] play() failed\n",{sound:e,duration:t},i)})),setTimeout((()=>{this.playing=!1}),t))}async setDevice(e){var t,i,s;(0,n.d)(this.meeting)||await(null===(s=null===(i=null===(t=this.audio)||void 0===t?void 0:t.setSinkId)||void 0===i?void 0:i.call(t,e))||void 0===s?void 0:s.catch((e=>{a.l.error("[dyte-notifications] setSinkId() error\n",e)})))}}},32599:(e,t,i)=>{i.d(t,{s:()=>n});const n=(e,t=!0)=>{null!=e&&e.scrollTo({top:e.scrollHeight,behavior:t?"smooth":"auto"})}},1821:(e,t,i)=>{i.d(t,{a:()=>s,f:()=>o,g:()=>c,h:()=>a,s:()=>n});const n=(e,t=20)=>null==e?"":e.length>t?`${e.substring(0,t)}...`:e,a=e=>/^\p{Emoji}+$/u.test(e)&&!/^\d+$/.test(e),s=e=>(null==e?void 0:e.trim().toLowerCase().startsWith("javascript:"))?"https://dyte.io":e,o=e=>""===(e=null==e?void 0:e.trim())?"Participant":e,r=new RegExp(/[^\u00BF-\u1FFF\u2C00-\uD7FF\w\s]/,"g"),d=new RegExp(/\s+/);function c(e,t=2){return e.replace(r,"").trim().split(d).slice(0,t).map((e=>e.charAt(0))).join("").toUpperCase()}}}]);