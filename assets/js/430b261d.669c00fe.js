"use strict";(self.webpackChunkdyte_docs=self.webpackChunkdyte_docs||[]).push([[63249],{87286:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>a,default:()=>c,frontMatter:()=>o,metadata:()=>l,toc:()=>r});var s=n(74848),i=n(28453);const o={title:"Export Chat Messages",sidebar_position:8,sidebar_slug:"export-chat-dump"},a="Export Chat of a Session",l={id:"capabilities/chat/export-chat-dump",title:"Export Chat Messages",description:"You can programmatically retrieve all chat messages of a Dyte session in the following ways:",source:"@site/docs/guides/capabilities/chat/export-chat-dump.mdx",sourceDirName:"capabilities/chat",slug:"/capabilities/chat/export-chat-dump",permalink:"/docs/guides/capabilities/chat/export-chat-dump",draft:!1,unlisted:!1,editUrl:"https://github.com/dyte-io/docs/tree/main/docs/guides/capabilities/chat/export-chat-dump.mdx",tags:[],version:"current",lastUpdatedAt:1709899166,formattedLastUpdatedAt:"Mar 8, 2024",sidebarPosition:8,frontMatter:{title:"Export Chat Messages",sidebar_position:8,sidebar_slug:"export-chat-dump"},sidebar:"tutorialSidebar",previous:{title:"Meeting Transcription",permalink:"/docs/guides/capabilities/ai/meeting-transcription"},next:{title:"Basics",permalink:"/docs/guides/capabilities/plugins"}},d={},r=[{value:"Get <code>chat_download_url</code>",id:"get-chat_download_url",level:2},{value:"Download the chat dump file",id:"download-the-chat-dump-file",level:2},{value:"Download on the client",id:"download-on-the-client",level:3},{value:"Download on the server",id:"download-on-the-server",level:3},{value:"Example: CSV chat dump file",id:"example-csv-chat-dump-file",level:2}];function h(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components},{Head:n}=t;return n||function(e,t){throw new Error("Expected "+(t?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Head",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h1,{id:"export-chat-of-a-session",children:"Export Chat of a Session"}),"\n",(0,s.jsx)(t.p,{children:"You can programmatically retrieve all chat messages of a Dyte session in the following ways:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["Using ",(0,s.jsx)(t.a,{href:"/api/?v=v2#/operations/GetSessionChat",children:"Chat Replay API"})]}),"\n",(0,s.jsxs)(t.li,{children:["Setting up webhook for the ",(0,s.jsx)(t.a,{href:"/guides/capabilities/webhooks/webhook-events#meetingchatsynced",children:"meeting.chatSynced"})," event"]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"This guide walks you through the steps involved in exporting chat dump of a session using Chat Replay API."}),"\n",(0,s.jsxs)(t.p,{children:["If you wish to use webhooks, see ",(0,s.jsx)(t.a,{href:"/guides/capabilities/webhooks/webhooks-and-events",children:"Set Up Webhooks"})," and ",(0,s.jsx)(t.a,{href:"/guides/capabilities/webhooks/webhook-events#meetingchatsynced",children:"meeting.chatSynced"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:["Once ",(0,s.jsx)(t.a,{href:"/api/?v=v2#/operations/GetSessionChat",children:"Chat Replay API"})," is enabled, do the\nfollowing:"]}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:["Get the ",(0,s.jsx)(t.code,{children:"chat_download_url"})," using\n",(0,s.jsx)(t.a,{href:"/api/?v=v2#/operations/GetSessionChat",children:"Chat Replay API"}),"."]}),"\n",(0,s.jsx)(t.li,{children:"Download the chat dump CSV file."}),"\n"]}),"\n",(0,s.jsxs)(t.h2,{id:"get-chat_download_url",children:["Get ",(0,s.jsx)(t.code,{children:"chat_download_url"})]}),"\n",(0,s.jsxs)(t.p,{children:["To get the ",(0,s.jsx)(t.code,{children:"chat_download_url"}),", make a ",(0,s.jsx)(t.code,{children:"HTTP GET"})," request to\n",(0,s.jsx)(t.a,{href:"/api/?v=v2#/operations/GetSessionChat",children:"Chat Replay API"}),". The API returns the\nfollowing:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-json",children:'{\n  "success": true,\n  "data": {\n    "chat_download_url": "string",\n    "chat_download_url_expiry": "string"\n  }\n}\n'})}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["The ",(0,s.jsx)(t.code,{children:"chat_download_url"})," is a URL that allows you to download the entire chat dump of a session in CSV format from AWS S3."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"chat_download_url_expiry"})," indicates the expiry timestamp of the ",(0,s.jsx)(t.code,{children:"chat_download_url"}),". If the ",(0,s.jsx)(t.code,{children:"chat_download_url"})," gets expired, simply call this endpoint again to obtain a new download URL."]}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"download-the-chat-dump-file",children:"Download the chat dump file"}),"\n",(0,s.jsxs)(t.p,{children:["You can download the chat dump file in CSV format by making ",(0,s.jsx)(t.code,{children:"HTTP GET"})," request\nto ",(0,s.jsx)(t.code,{children:"chat_download_url"})," that you obtained in the previous step."]}),"\n",(0,s.jsx)(t.p,{children:"The process of downloading any file from a HTTP URL in JavaScript differs\nslightly based on whether you are doing it on client side or server side."}),"\n",(0,s.jsx)(t.h3,{id:"download-on-the-client",children:"Download on the client"}),"\n",(0,s.jsx)(t.p,{children:"To download at client side, do the following:"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:["Make a GET request to the ",(0,s.jsx)(t.code,{children:"chat_download_url"}),"."]}),"\n",(0,s.jsx)(t.li,{children:"Convert response to blob."}),"\n",(0,s.jsxs)(t.li,{children:["Create an invisible ",(0,s.jsx)(t.code,{children:"<a>"})," HTML element with download attribute and add the\nabove blob to it's ",(0,s.jsx)(t.code,{children:"href"}),"."]}),"\n",(0,s.jsxs)(t.li,{children:["Programmatically click on the ",(0,s.jsx)(t.code,{children:"<a>"})," element so that the browser automatically\nstarts downloading and then remove the ",(0,s.jsx)(t.code,{children:"<a>"})," element."]}),"\n"]}),"\n",(0,s.jsx)(t.h3,{id:"download-on-the-server",children:"Download on the server"}),"\n",(0,s.jsxs)(t.p,{children:["We use ",(0,s.jsx)(t.code,{children:"Node.js"})," streams to download files on the server, so the steps are as\nfollows:"]}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsx)(t.li,{children:"Create a writable stream for a local file."}),"\n",(0,s.jsxs)(t.li,{children:["Make a GET request to ",(0,s.jsx)(t.code,{children:"chat_download_url"}),"."]}),"\n",(0,s.jsxs)(t.li,{children:["Get a readable stream using ",(0,s.jsx)(t.code,{children:"res.body"})," and pipe to the writable stream\ncreated in the first step."]}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"example-csv-chat-dump-file",children:"Example: CSV chat dump file"}),"\n",(0,s.jsx)(t.p,{children:"This CSV file contains all the chat messages along with the participant's name\nand some other metadata. It includes the following column headings:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"id"}),": Unique chat message ID"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"participantId"}),": ID of the participant who sent the message"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"sessionId"}),": The session ID from which the chat message was sent"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"meetingId"}),": The ID of the meeting to which this session belongs"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"displayName"}),": Display name of the participant who sent this message"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"pinned"}),": A boolean that indicates if the current message was pinned or not"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"isEdited"}),": A boolean that indicates if the current message was edited or not"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"payloadType"}),": An ENUM that indicates the type of payload sent in the chat\nmessage. It can be one of TEXT_MESSAGE, IMAGE_MESSAGE, FILE_MESSAGE"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"payload"}),": The actual payload sent in the chat message"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"createdAt"}),": Timestamp when this chat message was sent"]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{src:"https://dyte.io/blog/content/images/size/w1600/2022/11/Dyte-Blog---Sample-Chat-Dump.png",alt:"Sample Chat Dump File"})}),"\n",(0,s.jsxs)(t.p,{children:["For more information on downloading the file, refer to\n",(0,s.jsx)(t.a,{href:"https://dyte.io/blog/fetch-chat-history-of-a-dyte-session/",children:"How to Fetch Chat History of a Dyte Session"}),"\nblog."]}),"\n",(0,s.jsxs)(n,{children:[(0,s.jsx)("title",{children:"Export Chat Messages Guide"}),(0,s.jsx)("meta",{name:"description",content:"Explore how to export chat dumps with Dyte's capabilities. Follow our guide for effective exporting and management of chat data."})]})]})}function c(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>a,x:()=>l});var s=n(96540);const i={},o=s.createContext(i);function a(e){const t=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),s.createElement(o.Provider,{value:t},e.children)}}}]);